<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pierre-Feuille-Ciseaux</title>
    <!-- Inclut Tailwind CSS pour un style rapide et responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- D√©finit une police de caract√®res -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap">
    <style>
        /* Animation de pulsation pour le gagnant */
        @keyframes pulse-winner {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7);
            }
            50% {
                transform: scale(1.1);
                box-shadow: 0 0 20px 10px rgba(76, 175, 80, 0.7);
            }
        }
        .winner-animation {
            animation: pulse-winner 1.5s infinite;
        }

        /* Styles sp√©cifiques pour le mode paysage sur mobile */
        @media screen and (orientation: landscape) and (max-height: 600px) {
            body { @apply p-2; }
            .game-container {
                @apply flex-row items-stretch overflow-auto p-4 gap-2 h-screen;
            }
            .choices {
                @apply flex-col;
            }
            .choice-button {
                width: 100%;
                @apply flex-row justify-start p-3;
            }
            .choice-button img {
                @apply w-8 h-8 mr-2;
            }
            h1, .score-display, .result-display, .reset-button {
                @apply flex-shrink-0;
            }
            .choice-display-container {
                @apply flex-col gap-4;
            }
        }
    </style>
</head>
<body class="flex flex-col justify-center items-center min-h-screen bg-gray-100 text-gray-800 p-4 font-inter">

    <div class="game-container bg-white p-6 rounded-2xl shadow-xl max-w-lg w-full flex flex-col gap-6">
        <h1 class="text-4xl font-bold text-center text-purple-700 mb-4">Pierre-Feuille-Ciseaux</h1>

        <div class="score-display flex justify-around items-center text-xl font-bold bg-purple-100 p-4 rounded-xl">
            <p>Joueur: <span id="playerScore" class="text-purple-700">0</span></p>
            <p>Ordinateur: <span id="computerScore" class="text-purple-700">0</span></p>
        </div>

        <!-- Section des choix affich√©s -->
        <div class="choice-display-container flex justify-around items-center gap-8 my-4">
            <div id="playerChoiceDisplay" class="flex flex-col items-center gap-2">
                <p class="font-bold">Votre choix</p>
                <img id="playerChoiceImg" class="w-24 h-24 transition-all duration-300 transform scale-0" alt="Votre choix">
            </div>
            <div id="result-text-container" class="flex flex-col items-center">
                 <p id="resultText" class="text-2xl font-bold text-gray-600 transition-all duration-300">...</p>
                 <span id="instructionText" class="text-xs text-gray-500">Cliquez pour jouer</span>
            </div>
            <div id="computerChoiceDisplay" class="flex flex-col items-center gap-2">
                <p class="font-bold">Ordinateur</p>
                <img id="computerChoiceImg" class="w-24 h-24 transition-all duration-300 transform scale-0" alt="Choix de l'ordinateur">
            </div>
        </div>

        <div class="choices flex justify-center gap-4 flex-wrap">
            <button id="pierre" class="choice-button flex flex-col items-center justify-center p-6 bg-purple-600 text-white rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105 hover:bg-purple-700 active:scale-95 w-[calc(33.33%-1rem)] min-w-[100px]">
                <img src="https://img.icons8.com/ios-filled/50/000000/rock.png" alt="Pierre" class="w-12 h-12 mb-2 filter invert">
                <span>Pierre</span>
            </button>
            <button id="feuille" class="choice-button flex flex-col items-center justify-center p-6 bg-purple-600 text-white rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105 hover:bg-purple-700 active:scale-95 w-[calc(33.33%-1rem)] min-w-[100px]">
                <img src="https://img.icons8.com/ios-filled/50/000000/paper.png" alt="Feuille" class="w-12 h-12 mb-2 filter invert">
                <span>Feuille</span>
            </button>
            <button id="ciseaux" class="choice-button flex flex-col items-center justify-center p-6 bg-purple-600 text-white rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105 hover:bg-purple-700 active:scale-95 w-[calc(33.33%-1rem)] min-w-[100px]">
                <img src="https://img.icons8.com/ios-filled/50/000000/scissors.png" alt="Ciseaux" class="w-12 h-12 mb-2 filter invert">
                <span>Ciseaux</span>
            </button>
        </div>

        <!-- Le bouton Rejouer a √©t√© d√©plac√© dans le popup -->
    </div>
    
    <!-- Fen√™tre contextuelle (popup) de fin de partie -->
    <div id="endGamePopup" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300 opacity-0 pointer-events-none">
        <div class="bg-white p-8 rounded-xl shadow-2xl text-center flex flex-col gap-6 transform scale-95 transition-transform duration-300">
            <h2 class="text-3xl font-bold text-purple-700">Partie Termin√©e !</h2>
            <p id="finalResultText" class="text-xl font-semibold text-gray-700">Le joueur a gagn√© la partie ! üéâ</p>
            <button id="popupResetButton" class="bg-red-500 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105 hover:bg-red-600 active:scale-95">Rejouer</button>
        </div>
    </div>

    <script>
        // Le script JavaScript du jeu
        document.addEventListener('DOMContentLoaded', () => {
            // S√©lecteurs d'√©l√©ments du DOM
            const playerButtons = document.querySelectorAll('.choice-button');
            const playerScoreSpan = document.getElementById('playerScore');
            const computerScoreSpan = document.getElementById('computerScore');
            const playerChoiceImg = document.getElementById('playerChoiceImg');
            const computerChoiceImg = document.getElementById('computerChoiceImg');
            const resultText = document.getElementById('resultText');
            const instructionText = document.getElementById('instructionText');
            
            // √âl√©ments du popup
            const endGamePopup = document.getElementById('endGamePopup');
            const finalResultText = document.getElementById('finalResultText');
            const popupResetButton = document.getElementById('popupResetButton');

            // Initialisation des scores
            let playerScore = 0;
            let computerScore = 0;
            const winningScore = 10; // Score √† atteindre pour gagner la partie

            // Options du jeu
            const choices = ['pierre', 'feuille', 'ciseaux'];
            // Mappage des options aux images
            const choiceImages = {
                'pierre': 'https://img.icons8.com/ios-filled/100/000000/rock.png',
                'feuille': 'https://img.icons8.com/ios-filled/100/000000/paper.png',
                'ciseaux': 'https://img.icons8.com/ios-filled/100/000000/scissors.png'
            };

            /**
             * Ajoute une animation de "gagnant" ou de "perdant".
             * @param {HTMLElement} element L'√©l√©ment √† animer.
             * @param {string} type Le type d'animation ('winner' ou 'loser').
             */
            function animateChoice(element, type) {
                // R√©initialise les animations pr√©c√©dentes
                element.classList.remove('winner-animation', 'opacity-50');

                // Applique la nouvelle animation
                if (type === 'winner') {
                    element.classList.add('winner-animation');
                } else if (type === 'loser') {
                    element.classList.add('opacity-50');
                }
            }
            
            /**
             * Choisit al√©atoirement une option pour l'ordinateur.
             * @returns {string} Le choix de l'ordinateur.
             */
            function getComputerChoice() {
                const randomIndex = Math.floor(Math.random() * choices.length);
                return choices[randomIndex];
            }

            /**
             * D√©termine le gagnant du tour.
             * @param {string} playerChoice Le choix du joueur.
             * @param {string} computerChoice Le choix de l'ordinateur.
             * @returns {string} 'gagn√©', 'perdu' ou '√©galit√©'.
             */
            function determineWinner(playerChoice, computerChoice) {
                if (playerChoice === computerChoice) {
                    return '√©galit√©';
                }
                if (
                    (playerChoice === 'pierre' && computerChoice === 'ciseaux') ||
                    (playerChoice === 'feuille' && computerChoice === 'pierre') ||
                    (playerChoice === 'ciseaux' && computerChoice === 'feuille')
                ) {
                    return 'gagn√©';
                }
                return 'perdu';
            }

            /**
             * V√©rifie si un joueur a atteint le score de victoire et met fin √† la partie si c'est le cas.
             */
            function checkGameWinner() {
                if (playerScore === winningScore) {
                    endGame('joueur');
                } else if (computerScore === winningScore) {
                    endGame('ordinateur');
                }
            }

            /**
             * Met fin √† la partie et affiche le r√©sultat final dans un popup.
             * @param {string} winner Le nom du gagnant ('joueur' ou 'ordinateur').
             */
            function endGame(winner) {
                if (winner === 'joueur') {
                    finalResultText.textContent = `Vous avez gagn√© la partie ! üéâ`;
                } else {
                    finalResultText.textContent = `L'ordinateur a gagn√© la partie... üò≠`;
                }
                
                // Affiche le popup
                endGamePopup.classList.remove('opacity-0', 'pointer-events-none');
                endGamePopup.querySelector('div').classList.remove('scale-95');

                // D√©sactive les boutons du jeu principal
                playerButtons.forEach(button => button.disabled = true);
            }

            /**
             * Met √† jour l'interface du jeu apr√®s un tour.
             * @param {string} playerChoice Le choix du joueur.
             * @param {string} computerChoice Le choix de l'ordinateur.
             * @param {string} result Le r√©sultat du tour.
             */
            function updateGame(playerChoice, computerChoice, result) {
                // Masque les images pendant la mise √† jour pour un effet de transition
                playerChoiceImg.classList.add('scale-0');
                computerChoiceImg.classList.add('scale-0');

                // Attend un court instant pour la transition avant d'afficher les nouvelles images
                setTimeout(() => {
                    // Met √† jour les affichages des choix avec les images
                    playerChoiceImg.src = choiceImages[playerChoice];
                    playerChoiceImg.alt = `Votre choix: ${playerChoice}`;
                    computerChoiceImg.src = choiceImages[computerChoice];
                    computerChoiceImg.alt = `Choix de l'ordinateur: ${computerChoice}`;
                    
                    // Affiche les images avec une transition
                    playerChoiceImg.classList.remove('scale-0');
                    computerChoiceImg.classList.remove('scale-0');

                    // Met √† jour le texte du r√©sultat et les scores
                    if (result === 'gagn√©') {
                        playerScore++;
                        resultText.textContent = `Vous avez gagn√© le tour !`;
                        resultText.className = 'text-2xl font-bold mt-2 text-green-600 transition-all duration-300';
                        animateChoice(playerChoiceImg, 'winner');
                        animateChoice(computerChoiceImg, 'loser');
                    } else if (result === 'perdu') {
                        computerScore++;
                        resultText.textContent = `Vous avez perdu le tour...`;
                        resultText.className = 'text-2xl font-bold mt-2 text-red-600 transition-all duration-300';
                        animateChoice(computerChoiceImg, 'winner');
                        animateChoice(playerChoiceImg, 'loser');
                    } else {
                        resultText.textContent = `√âgalit√© !`;
                        resultText.className = 'text-2xl font-bold mt-2 text-yellow-600 transition-all duration-300';
                        animateChoice(playerChoiceImg, 'none');
                        animateChoice(computerChoiceImg, 'none');
                    }

                    playerScoreSpan.textContent = playerScore;
                    computerScoreSpan.textContent = computerScore;
                    instructionText.textContent = 'Continuez de jouer !';

                    checkGameWinner(); // V√©rifie si la partie est termin√©e
                }, 300); // Dur√©e de la transition CSS
            }

            /**
             * G√®re un tour de jeu complet lorsqu'un bouton est cliqu√©.
             * @param {Event} event L'√©v√©nement de clic.
             */
            function playRound(event) {
                const playerChoice = event.currentTarget.id;
                const computerChoice = getComputerChoice();
                const result = determineWinner(playerChoice, computerChoice);
                updateGame(playerChoice, computerChoice, result);
            }

            /**
             * R√©initialise le jeu √† son √©tat initial.
             */
            function resetGame() {
                playerScore = 0;
                computerScore = 0;
                playerScoreSpan.textContent = playerScore;
                computerScoreSpan.textContent = computerScore;
                resultText.textContent = 'Cliquez sur une option pour commencer !';
                resultText.className = 'text-2xl font-bold mt-2 text-gray-600 transition-all duration-300';
                instructionText.textContent = 'Cliquez pour jouer';
                playerChoiceImg.classList.add('scale-0');
                computerChoiceImg.classList.add('scale-0');
                // R√©active les boutons pour pouvoir rejouer
                playerButtons.forEach(button => button.disabled = false);
                // Cache le popup
                endGamePopup.classList.add('opacity-0', 'pointer-events-none');
                endGamePopup.querySelector('div').classList.add('scale-95');
            }

            // Ajoute des √©couteurs d'√©v√©nements aux boutons de choix et de r√©initialisation
            playerButtons.forEach(button => {
                button.addEventListener('click', playRound);
            });
            popupResetButton.addEventListener('click', resetGame);
        });
    </script>
</body>
</html>
